define(function(){var h={handler:[],children:{}},i=function(){};i.prototype={subscribe:function(f,d){for(var a=h,c=f.split("."),b=0;b<c.length;++b){var e=c[b],a=a.children;a[e]===void 0&&(a[e]={handler:[],children:{}});a=a[c[b]]}a.handler.push(d)},publish:function(f,d){for(var d=d||{},a=h,c=f.split("."),b=[],e=b.push,g=0;g<c.length&&a.children[c[g]]!==void 0;++g)e.apply(b,a.handler),a=a.children[c[g]];e.apply(b,a.handler);for(a=0;a<b.length;++a)b[a].call(null,d,f)}};return new i});