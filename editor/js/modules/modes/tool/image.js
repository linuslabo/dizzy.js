define(["sandbox"],function(b){var a,g={depends:[],start:function(){b.publish("ui.dialog.open",{filetypes:[],readAs:{link:!0,file:"dataUrl"},success:function(d,a){b.publish("dizzy.presentation.insertImage",{ref:a});b.publish("dizzy.ui.toolbar.clicked.mode.tool-default",{button:"tool-default"})},cancel:function(){b.publish("dizzy.ui.toolbar.clicked.mode.tool-default",{button:"tool-default"})}});$(document).bind("contextmenu",function(a){a.preventDefault();a.stopPropagation();return!1})},stop:function(){$(document).unbind("contextmenu")}};
b.subscribe("dizzy.presentation.loaded",function(b){a=b.canvas});b.subscribe("dizzy.presentation.insertImage",function(d){a.getGroup(0);var e=a.createGroup(),c=new Image;c.onload=function(){var f=a.vectorTranslate({x:c.width,y:c.height},{ignoreCanvas:!0});$(a.svg.image(e.dom(),((a.WIDTH-f.x)/2).toString(),((a.HEIGHT-f.y)/2).toString(),Math.max(c.width,600)+"px",Math.max(c.height,600)+"px",d.ref));c.src="";b.publish("dizzy.canvas.group.created.image",{group:e})};c.src=d.ref});return{init:function(){b.publish("dizzy.modes.register",
{name:"tool-image",instance:g})},destroy:function(){}}});