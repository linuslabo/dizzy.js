define(["sandbox"],function(b){var a;b.subscribe("dizzy.ui.slider.closed",function(){reopen.show("slow")});b.subscribe("dizzy.ui.slider.close",function(){a.hide("slow");console.log("slider closed.");b.publish("dizzy.ui.slider.closed.",{slider:a})});return{init:function(){var c=this,d=$("#container");$.get("php/testPhp.php",function(e){console.log("Referrer:"+document.referrer+":");e.substring(0,5)=="<?php"?console.warn("PHP is not enabled on this server -> slider can't be loaded"):document.referrer==
"http://172.16.15.73/home.php"&&$.get("html/slider.html").success(function(c){d.prepend(c);a=d.find("#anteprime");reopen=d.find("#apriAnteprime");b.publish("dizzy.ui.slider.loaded",{slider:a});$(document).delegate('a[class="preview"] > img, #preview',"click",function(a){a.preventDefault();if($("#preview").length>0)$("#preview").remove();else{$("#preview").remove();xOffset=10;yOffset=30;wi=500;he=400;this.t=this.title;this.title="";var b=this.t!=""?"<br/>"+this.t:"";$("body").append("<p id='preview'><img src='"+
$(this).parent().attr("href")+"' WIDTH=\""+wi+'" HEIGHT="'+he+"\" alt='Image preview' />"+b+"</p>");$("#preview").css("top",a.pageY-xOffset-he+"px");a.pageX+yOffset+wi>$(window).width()?$("#preview").css("left",a.pageX-wi-yOffset+"px"):$("#preview").css("left",a.pageX+yOffset+"px");$("#preview").fadeIn(0)}})}).error(function(){}).complete(function(){c.assignEventHandlers();console.log("slider loaded.")})})},assignEventHandlers:function(){a.delegate("#x","click",function(){a.hide("slow");console.log("slider closed.");
b.publish("dizzy.ui.slider.closed.",{slider:a})});reopen.bind("click",function(){a.show("slow");reopen.hide("slow");console.log("slider opened");b.publish("dizzy.ui.slider.opened.",{slider:a})})},destroy:function(){$("#slider").remove()}}});