define(["sandbox"],function(c){var d;c.subscribe("dizzy.ui.toolbar.loaded",function(){var a=$("#menu"),e=a.find("#menu-right");a.disableTextSelect();c.subscribe("dizzy.ui.toolbar.clicked.menu-button",function(){a.toggleClass("hidden");c.publish("dizzy.ui.canvas.focus",{hasFocus:a.hasClass("hidden")})});a.delegate(".menu-option","click",function(){switch($(this).attr("id")){case "menu-save":var b=d.serialize(),b="data:image/svg+xml;charset=utf-8;base64,"+$.base64Encode(b);window.open(b);break;case "menu-download":b=
d.serialize();$.post("php/downloadSVG.php",{svg:b},function(b){window.open("php/"+b,"Download")});break;case "menu-about":$("#menu-bugs-extended").addClass("hidden");$("#menu-about-extended").toggleClass("hidden");break;case "menu-bugs":$("#menu-about-extended").addClass("hidden"),$("#menu-bugs-extended").toggleClass("hidden")}});a.delegate(".menu-option","hover",function(){var b=$(this).attr("data-description");b&&e.text(b)});a.delegate("#tool-input-color-background","change",function(){$("svg").first().css("background-color",
$(this).val())});$("#menu-open-input").bind("change",function(b){var a=b.target.files;if(a.length>=1&&a[0].type==="image/svg+xml")b=new FileReader,a=a[0],b.onload=function(a){c.publish("dizzy.presentation.loadSVG",{svgDoc:a.target.result})},b.readAsText(a)})});c.subscribe("dizzy.presentation.loaded",function(a){d=a.canvas});return{init:function(){},destroy:function(){}}});