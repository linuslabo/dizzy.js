define(["sandbox"],function(f){function g(){a.delegate(".dialog-cancel","click",function(){a.hide();b.hide();e.cancel()});a.delegate(".dialog-ok","click",function(){var c=a.find(".dialog-open-local-input")[0].files;if(c.length>0&&c[0].type.indexOf("image/")>=0){var d=new FileReader,c=c[0];d.onload=function(a){e.success("dataURL",a.target.result)};d.readAsDataURL(c)}else d=a.find(".dialog-open-link-input").val(),d!==void 0&&e.success("link",d);a.find("form")[0].reset();a.hide();b.hide()})}var a,b;
f.subscribe("ui.dialog.open",function(c){b.show();a.show();$.extend(e,c)});f.subscribe("ui.dialog.save",function(){});var e={success:function(){},cancel:function(){}};return{init:function(){var c=$("#container");b=$("#dialog-overlay");b.size()===0&&$.get("html/dialog-overlay.html").success(function(a){b=$(a);b.hide();b.removeClass("hidden");c.prepend(b)});a=$("#dialog-open");a.size()===0&&$.get("html/dialog-open.html").success(function(b){a=$(b);c.prepend(a);a.hide();a.removeClass("hidden");g()})},
destroy:function(){}}});